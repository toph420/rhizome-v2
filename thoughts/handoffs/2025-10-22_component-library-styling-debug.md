# Component Library Styling - Debug Handoff

**Date**: 2025-10-22
**Status**: üî¥ NOT WORKING - Requires Debug Session
**Priority**: HIGH

---

## Problem Statement

Component libraries (Neobrutalism & RetroUI) downloaded successfully but **styling is not rendering correctly** on `/design` page ‚Üí Libraries tab ‚Üí Side-by-Side Comparison.

**Expected**: Components should have brutalist styling (hard shadows, bold borders, proper colors)
**Actual**: Components render but appear unstyled or with default/minimal styling

---

## What We Have

### ‚úÖ Successfully Downloaded
- **76 components** total (44 Neobrutalism + 32 RetroUI)
- All components in `src/components/libraries/neobrutalism/` and `src/components/libraries/retroui/`
- Components import and render without errors

### ‚úÖ Files Created
1. `src/styles/neobrutalism.css` - Neobrutalism theme CSS
2. `src/styles/retroui.css` - RetroUI theme CSS
3. `src/components/design/ThemeWrappers.tsx` - Theme scope wrappers
4. `src/components/design/ComponentComparison.tsx` - Side-by-side comparison page

### ‚úÖ Current Setup
```tsx
// ComponentComparison.tsx
<NeobrutalismTheme>  {/* Applies .neobrutalism-theme class */}
  <NeoButton>Click me</NeoButton>
</NeobrutalismTheme>

<RetroUITheme>  {/* Applies .retroui-theme class */}
  <RetroButton>Click me</RetroButton>
</RetroUITheme>
```

---

## Root Cause Analysis

### The Core Issue

Components use **Tailwind utility classes** that require CSS custom properties to be defined in Tailwind's `@theme` block:

**Neobrutalism Button (`button.tsx:14`)** uses:
```tsx
"bg-main border-2 border-border shadow-shadow
 hover:translate-x-boxShadowX hover:translate-y-boxShadowY"
```

**These Tailwind classes need:**
- `bg-main` ‚Üí requires `--color-main` in `@theme`
- `shadow-shadow` ‚Üí requires `--shadow-shadow` in `@theme`
- `translate-x-boxShadowX` ‚Üí requires `--translate-boxShadowX` in `@theme`
- `rounded-base` ‚Üí requires `--radius-base` in `@theme`

### What Was Attempted

**Attempt 1**: Added CSS variables to scoped classes (`.neobrutalism-theme`)
- ‚ùå **Failed**: Tailwind can't see scoped CSS variables for utility generation

**Attempt 2**: Added inline styles to wrapper components
- ‚ùå **Failed**: Same issue - Tailwind utilities generated at build time

**Attempt 3**: Added `@theme` mappings with `var()` fallbacks
- ‚ùì **Current state**: Should work theoretically, but not rendering

---

## Current Configuration

### globals.css @theme Block
```css
@theme inline {
  /* Neobrutalism colors - reference scoped variables with fallbacks */
  --color-main: var(--main, var(--primary));
  --color-main-foreground: var(--main-foreground, var(--primary-foreground));
  --shadow-shadow: var(--shadow, 4px 4px 0px 0px hsl(var(--border)));
  --translate-boxShadowX: var(--boxShadowX, 4px);
  --radius-base: var(--rounded-base, var(--radius));
  /* ... etc */
}
```

### neobrutalism.css
```css
.neobrutalism-theme {
  --main: oklch(0.205 0 0);
  --main-foreground: oklch(0.985 0 0);
  --shadow: 4px 4px 0px 0px oklch(0.145 0 0);
  --boxShadowX: 4px;
  --rounded-base: 0.5rem;
  /* ... etc */
}
```

### retroui.css
```css
.retroui-theme {
  --primary: 50 100% 60%;  /* Yellow */
  --shadow: 3px 3px 0 0 hsl(0 0% 0%);
  --shadow-md: 4px 4px 0 0 hsl(0 0% 0%);
  /* ... etc */
}
```

---

## Debug Checklist

### 1. Verify Tailwind Utility Generation
```bash
# Build and check if utilities are generated
npx next build --no-lint

# Check if bg-main, shadow-shadow classes exist in build output
# Look in .next/static/css/*.css for these classes
```

**Question**: Are `bg-main`, `shadow-shadow`, `translate-x-boxShadowX` actually being generated by Tailwind?

### 2. Inspect Browser DevTools
In browser on `/design` page:
1. Inspect a Neobrutalism button
2. Check computed styles
3. Look for CSS custom properties in DevTools

**Questions**:
- Is `.neobrutalism-theme` class applied to wrapper div?
- Are CSS variables (`--main`, `--shadow`) visible in computed styles?
- Are Tailwind classes (`bg-main`, `shadow-shadow`) present in DOM?
- What do the computed styles show for these classes?

### 3. Check CSS Import Order
File: `src/app/globals.css`
```css
@import "tailwindcss";
@plugin "@tailwindcss/typography";
@import "tw-animate-css";
@import "../styles/retroui.css";
@import "../styles/neobrutalism.css";
```

**Question**: Is the import order causing conflicts?

### 4. Test Isolated Component
Create simple test:
```tsx
// Test if Tailwind sees the variables
<div className="neobrutalism-theme">
  <div className="bg-main p-4">Does this have color?</div>
  <div className="shadow-shadow">Does this have shadow?</div>
</div>
```

### 5. Check Tailwind v4 Syntax
Tailwind v4 uses different configuration syntax than v3.

**Question**: Are we using the correct Tailwind v4 syntax for custom values?

Tailwind v4 docs: https://tailwindcss.com/docs/v4-beta

---

## Key Files to Examine

### Components (What classes they use)
1. `src/components/libraries/neobrutalism/button.tsx:14` - Check `buttonVariants` cva
2. `src/components/libraries/retroui/Button.tsx:12` - Check `buttonVariants` cva

### Styling
3. `src/app/globals.css:9-75` - @theme block with variable mappings
4. `src/styles/neobrutalism.css:10-30` - .neobrutalism-theme class
5. `src/styles/retroui.css:10-55` - .retroui-theme class

### Usage
6. `src/components/design/ComponentComparison.tsx:52-92` - Wrapped components
7. `src/components/design/ThemeWrappers.tsx:19-28` - Wrapper implementation

---

## Potential Issues to Investigate

### Issue 1: Tailwind v4 Doesn't Support `var()` in @theme
**Hypothesis**: Maybe Tailwind v4 doesn't allow `var(--main, fallback)` syntax in @theme

**Test**: Try defining values directly instead of var()
```css
@theme {
  --color-main: oklch(0.205 0 0);  /* Direct value, not var() */
}
```

### Issue 2: CSS Variable Format Mismatch
**Hypothesis**: Color format mismatch (OKLCH vs HSL)

**Neobrutalism uses**: `oklch(0.205 0 0)`
**RetroUI uses**: `50 100% 60%` (space-separated HSL)

**Test**: Check if Tailwind expects specific format

### Issue 3: Build-time vs Runtime
**Hypothesis**: Tailwind generates utilities at build time, can't pick up runtime CSS variables

**Test**: Does Tailwind v4 support CSS-variable-based utilities?

### Issue 4: Missing Tailwind Plugin/Config
**Hypothesis**: Need to configure Tailwind to recognize custom theme values

**Test**: Check if Tailwind v4 needs explicit configuration for custom utilities

### Issue 5: Specificity/Override Issues
**Hypothesis**: Global styles overriding scoped theme styles

**Test**: Check specificity in browser DevTools

---

## Next Steps for Debug Session

1. **Browser Inspect**:
   - Open `/design` ‚Üí Libraries ‚Üí Side-by-Side Comparison
   - Inspect Neobrutalism button
   - Screenshot computed styles
   - Check if CSS variables are defined
   - Check if Tailwind classes are present

2. **Build Output Check**:
   ```bash
   npx next build --no-lint
   # Check .next/static/css/*.css for bg-main, shadow-shadow
   ```

3. **Simplified Test Case**:
   Create minimal reproduction in ComponentComparison to isolate issue

4. **Tailwind v4 Research**:
   - Check Tailwind v4 docs for CSS variable support
   - Check if @theme supports var() syntax
   - Look for examples of scoped theme variables

5. **Alternative Approaches**:
   - Could we use CSS @layer instead?
   - Could we use Tailwind arbitrary values `bg-[var(--main)]`?
   - Should we abandon theme wrappers and use different component instances?

---

## Questions to Answer

1. Are Tailwind utilities (`bg-main`) being generated at all?
2. If yes, are they using the correct CSS variables?
3. Are CSS variables (`--main`) visible in browser DevTools?
4. Does Tailwind v4 support `var()` in `@theme`?
5. Is there a format mismatch (OKLCH vs HSL)?
6. Are wrapper divs actually applying the theme classes?

---

## Success Criteria

When working, you should see in browser:

**Neobrutalism (Left)**:
- Dark gray/black button background
- 2px solid black border
- 4px hard black shadow (no blur)
- Hover: button translates 4px right/down
- Sharp, brutalist aesthetic

**RetroUI (Right)**:
- Yellow button background (#ffdb33-ish)
- 2px solid black border
- 3-4px hard black shadow
- Hover: slight translation
- Retro, playful aesthetic

---

## Git Status

**Branch**: `design`
**Last Commit**: `fb9d51f` - "fix(design): expose scoped theme variables to Tailwind"

**Modified Files**:
- `src/app/globals.css`
- `src/styles/neobrutalism.css`
- `src/styles/retroui.css`
- `src/components/design/ThemeWrappers.tsx`
- `src/components/design/ComponentComparison.tsx`

---

## Resources

- Tailwind v4 Docs: https://tailwindcss.com/docs/v4-beta
- Neobrutalism Docs: https://www.neobrutalism.dev
- RetroUI Docs: https://www.retroui.dev
- Current project using Tailwind v4 with @theme inline syntax

---

**Good luck debugging! üîß**
